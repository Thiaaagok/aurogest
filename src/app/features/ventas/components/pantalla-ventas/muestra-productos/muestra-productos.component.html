<div class="relative w-70">
  <p-iconfield iconPosition="left">
    <p-inputicon>
      <i class="pi pi-search text-xs"></i>
    </p-inputicon>

    <input pInputText type="text" class="w-full text-sm px-2 py-2" placeholder="Código o descripción"
      [(ngModel)]="filtroBusqueda" (input)="onInput()" (keydown)="onKeyDown($event)" />
  </p-iconfield>

  <div *ngIf="mostrarAutocomplete" class="autocomplete-panel">
    <div *ngFor="let prod of productos; let i = index" class="autocomplete-item"
      [class.active]="i === indiceSeleccionado" (click)="seleccionarProducto(prod)">
      <span class="text-gray-500 truncate">{{ prod.Codigo }} - {{ prod.Descripcion }} </span>
    </div>
  </div>
</div>

<div class="flex flex-wrap gap-3 mt-2 justify-around text-sm ">
  <p-card [style]="{ width: '12rem', overflow: 'hidden', height: 'fit-content' }" class="text-sm card-hover">
    <ng-template #header>
      <img style="width: 150px; height: 150px; object-fit: contain; justify-self: center;" src="assets/no-imagen.jpg"
        alt="Imagen del producto" />
    </ng-template>
    <ng-template #title>
      <span class="block text-xs font-medium truncate">Otros Varios</span>
    </ng-template>
    <ng-template #subtitle>
      <span class="text-xs text-gray-500">OTROS</span>
    </ng-template>
  </p-card>
  @for(producto of productos; track $index){
  <p-card [style]="{ width: '12rem', overflow: 'hidden', height: 'fit-content' }"
    (click)="productoSeleccionado(producto)" class="text-sm card-hover product-card">
    <ng-template #header>
      <img style="width: 150px; height: 150px; object-fit: contain; justify-self: center;"
        *ngIf="producto?.Imagenes?.length" [src]="producto.Imagenes[0]" alt="Imagen del producto" />
      <img *ngIf="!producto?.Imagenes?.length"
        style="width: 150px; height: 150px; object-fit: contain; justify-self: center;" src="assets/no-imagen.jpg" />
    </ng-template>
    <ng-template #title>
      <span class="block text-xs font-medium truncate">{{producto.Descripcion}}</span>
    </ng-template>
    <ng-template #subtitle>
      <span class="text-xs text-gray-500">{{producto.Codigo}}</span>
    </ng-template>
    <p class="text-xs producto-precio font-semibold mt-1">${{producto.PrecioVenta}}</p>
  </p-card>
  }
</div>